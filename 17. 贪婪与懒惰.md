# 17. 贪婪与懒惰

当正则表达式中包含能接受重复的限定符时，通常的行为是（在使整个表达式能得到匹配的前提下）匹配**尽可能多**的字符。以这个表达式为例：`a.*b`，它将会匹配<u>`最长的以a开始，以b结束的字符串`</u>。如果用它来搜索<span style="color: red;">`aabab`</span>的话，它会匹配整个字符串<u>`aabab`</u>。这被称为**贪婪**匹配。

有时，我们更需要**懒惰**匹配，也就是匹配**尽可能少**的字符。前面给出的限定符都可以被转化为懒惰匹配模式，只要在它后面加上一个问号<span style="color: blue;">`?`</span>。这样`.*?`就意味着<u>`匹配任意数量的重复，但是在能使整个匹配成功的前提下使用最少的重复`</u>。现在看看懒惰版的例子吧：

`a.*?b`匹配<u>`最短的，以a开始，以b结束的字符串`</u>。如果把它应用于<span style="color: red;">`aabab`</span>的话，它会匹配<u>`aab（第一到第三个字符）`</u>和<u>`ab（第四到第五个字符）`</u>。

表5.懒惰限定符：

| 代码/语法 | 说明 |
| -- | -- |
| <span style="color: blue;">`*?`</span> | <u>`重复任意次，但尽可能少重复`</u> |
| <span style="color: blue;">`+?`</span> | <u>`重复1次或更多次，但尽可能少重复`</u> |
| <span style="color: blue;">`??`</span> | <u>`重复0次或1次，但尽可能少重复`</u> |
| <span style="color: blue;">`{n,m}?`</span> | <u>`重复n到m次，但尽可能少重复`</u> |
| <span style="color: blue;">`{n,}?`</span> | <u>`重复n次以上，但尽可能少重复`</u> |

> 注：
> 
> 为什么第一个匹配是aab（第一到第三个字符）而不是ab（第二到第三个字符）？简单地说，因为正则表达式有另一条规则，比懒惰／贪婪规则的优先级更高：最先开始的匹配拥有最高的优先权——The match that begins earliest wins。